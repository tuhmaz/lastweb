<?php

return [
    /*
    |--------------------------------------------------------------------------
    | إعدادات تقييد معدل الطلبات
    |--------------------------------------------------------------------------
    |
    | هذا الملف يحتوي على إعدادات تقييد معدل الطلبات لحماية التطبيق من هجمات القوة الغاشمة.
    |
    */

    /*
    | تفعيل تقييد معدل الطلبات
    | عند تعيين هذه القيمة إلى true، سيتم تطبيق تقييد معدل الطلبات على نقاط النهاية المحددة.
    */
    'enabled' => env('RATE_LIMITING_ENABLED', true),

    /*
    | رسالة الخطأ عند تجاوز الحد المسموح به
    | يمكن استخدام :seconds لعرض عدد الثواني المتبقية قبل إعادة المحاولة
    */
    'error_message' => 'لقد تجاوزت الحد المسموح به من الطلبات. يرجى المحاولة مرة أخرى بعد :seconds ثانية.',

    /*
    | رمز الاستجابة عند تجاوز الحد المسموح به
    | 429 هو الرمز القياسي لـ "Too Many Requests"
    */
    'response_code' => 429,

    /*
    | تسجيل محاولات تجاوز الحد المسموح به
    | عند تعيين هذه القيمة إلى true، سيتم تسجيل جميع محاولات تجاوز الحد المسموح به في قاعدة البيانات
    */
    'log_throttled_requests' => true,

    /*
    | قواعد تقييد معدل الطلبات العامة
    | هذه القواعد تنطبق على جميع نقاط النهاية ما لم يتم تجاوزها بقواعد محددة.
    | الصيغة: 'attempts,minutes' - عدد المحاولات المسموح بها خلال فترة زمنية (بالدقائق)
    */
    'global' => [
        'api' => '60,1',     // 60 طلب في الدقيقة لجميع نقاط نهاية API
        'web' => '120,1',    // 120 طلب في الدقيقة لجميع نقاط نهاية الويب
    ],

    /*
    | قواعد تقييد معدل الطلبات المحددة
    | هذه القواعد تنطبق على نقاط نهاية محددة وتتجاوز القواعد العامة.
    | الصيغة: 'route_name' => 'attempts,minutes'
    */
    'routes' => [
        // نقاط نهاية المصادقة
        'login' => '5,1',           // 5 محاولات تسجيل دخول في الدقيقة
        'register' => '3,1',        // 3 محاولات تسجيل في الدقيقة
        'password.email' => '3,10', // 3 محاولات إعادة تعيين كلمة المرور في 10 دقائق
        'password.reset' => '3,60', // 3 محاولات إعادة تعيين كلمة المرور في الساعة
        
        // نقاط نهاية API
        'api.token' => '10,1',      // 10 محاولات إنشاء رمز في الدقيقة
        
        // نقاط نهاية المسؤول
        'admin.*' => '30,1',        // 30 طلب في الدقيقة لجميع نقاط نهاية المسؤول
        
        // نقاط نهاية خريطة الموقع
        'sitemap.*' => '10,1',      // 10 طلبات في الدقيقة لجميع نقاط نهاية خريطة الموقع
    ],

    /*
    | قواعد تقييد معدل الطلبات حسب عنوان IP
    | هذه القواعد تنطبق على عناوين IP محددة.
    | الصيغة: 'ip_address' => 'attempts,minutes'
    | يمكن استخدام '*' كعلامة بدل لأي جزء من عنوان IP.
    */
    'ips' => [
        // قيود على عناوين IP محددة (مثال)
        // '192.168.1.*' => '20,1',  // 20 طلب في الدقيقة لجميع عناوين IP التي تبدأ بـ 192.168.1
    ],

    /*
    | قواعد تقييد معدل الطلبات حسب نوع المستخدم
    | هذه القواعد تنطبق على أنواع محددة من المستخدمين.
    | الصيغة: 'user_type' => 'attempts,minutes'
    */
    'users' => [
        'guest' => '30,1',     // 30 طلب في الدقيقة للزوار
        'default' => '60,1',   // 60 طلب في الدقيقة للمستخدمين المسجلين
        'admin' => '120,1',    // 120 طلب في الدقيقة للمسؤولين
    ],

    /*
    | قائمة عناوين IP المحظورة
    | هذه العناوين سيتم حظرها بشكل دائم من الوصول إلى التطبيق.
    | يمكن استخدام '*' كعلامة بدل لأي جزء من عنوان IP.
    */
    'blocked_ips' => [
        // أمثلة على عناوين IP محظورة
        // '123.456.789.0',
        // '192.168.1.*',
    ],

    /*
    | مدة الحظر الافتراضية (بالدقائق) عند تجاوز الحد المسموح به
    | سيتم حظر المستخدم لهذه المدة عند تجاوز الحد المسموح به من الطلبات
    */
    'default_block_duration' => 5,
];
